{
  "certificationId": "lithium_battery_local_products",
  "title": "Lithium Battery - Local Products Form",
  "fields": [
    {
      "key": "category",
      "type": "select",
      "templateOptions": {
        "label": "Category",
        "required": true,
        "options": [],
        "loading": true,
        "placeholder": "Loading categories..."
      },
      "hooks": {
        "onInit": "loadLocalCategories",
        "onChanges": "onCategoryChange"
      },
      "validation": {
        "messages": {
          "required": "Category selection is mandatory"
        }
      }
    },
    {
      "key": "product",
      "type": "select",
      "templateOptions": {
        "label": "Product",
        "options": [],
        "disabled": true,
        "placeholder": "Select category first"
      },
      "hooks": {
        "onChanges": "productChanged"
      },
      "expressionProperties": {
        "templateOptions.disabled": "!model.category",
        "templateOptions.placeholder": "model.category ? 'Select product' : 'Select category first'",
        "templateOptions.required": "model.category && ['CAT001', 'CAT003', 'CAT005'].includes(model.category)"
      },
      "validators": {
        "validation": ["requiredIfCategory"]
      },
      "validation": {
        "messages": {
          "requiredIfCategory": "Product selection is required for this category"
        }
      }
    },
    {
      "key": "measuringUnit",
      "type": "input",
      "templateOptions": {
        "label": "Measuring Unit",
        "placeholder": "e.g., kg, liters, units"
      },
      "hideExpression": "!model.product"
    },
    {
      "key": "density",
      "type": "input",
      "templateOptions": {
        "label": "Density",
        "placeholder": "Enter density value"
      },
      "hideExpression": "!model.product"
    },
    {
      "key": "costPrice",
      "type": "input",
      "templateOptions": {
        "label": "Cost Price",
        "type": "number",
        "min": 0,
        "step": "0.01",
        "pattern": "^[0-9]+\\.?[0-9]*$",
        "required": true
      },
      "validators": {
        "validation": ["positiveNumber"]
      },
      "validation": {
        "messages": {
          "required": "Cost price is required",
          "pattern": "Please enter a valid numeric value"
        }
      },
      "hideExpression": "!model.category"
    },
    {
      "key": "expectedSalePrice",
      "type": "input",
      "templateOptions": {
        "label": "Expected Sale Price",
        "type": "number",
        "min": 0,
        "step": "0.01",
        "pattern": "^[0-9]+\\.?[0-9]*$",
        "required": false
      },
      "validators": {
        "validation": ["positiveNumber"]
      },
      "validation": {
        "messages": {
          "required": "Sale price is required",
          "pattern": "Please enter a valid numeric value"
        }
      },
      "hideExpression": "!model.product"
    },
    {
      "key": "vatCategory",
      "type": "select",
      "templateOptions": {
        "label": "VAT Category",
        "options": [],
        "disabled": true,
        "placeholder": "Select category first"
      },
      "expressionProperties": {
        "templateOptions.disabled": "!model.category",
        "templateOptions.placeholder": "model.category ? 'Select VAT rate' : 'Select category first'"
      },
      "hideExpression": "!model.product"
    }
  ]
}
