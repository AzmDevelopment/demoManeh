{
  "stepId": "saso_test_step3_products",
  "name": "Product Management",
  "actor": "customer",
  "description": "Add products with brand, sector, classification, measurements, and models",
  
  "fields": [
    {
      "key": "existingProduct",
      "type": "select",
      "templateOptions": {
        "label": "Select Existing Product",
        "placeholder": "Choose a product to add...",
        "required": false
      },
      "hooks": {
        "onInit": "loadProducts",
        "onChange": "onProductSelected"
      }
    },
    
    {
      "key": "productTable",
      "type": "table",
      "templateOptions": {
        "label": "Added Products",
        "columns": ["brandName", "sectorName", "classificationName", "modelName", "modelNumber", "source"],
        "columnHeaders": {
          "brandName": "Brand",
          "sectorName": "Sector",
          "classificationName": "Classification",
          "modelName": "Model",
          "modelNumber": "Model #",
          "source": "Source"
        },
        "emptyMessage": "No products added yet. Select an existing product or add a new one below.",
        "badgeColumns": {
          "source": {
            "Existing": "bg-info",
            "New": "bg-success"
          }
        },
        "allowDelete": true
      }
    },
    
    {
      "key": "newProduct",
      "type": "add-to-table",
      "templateOptions": {
        "addText": "âž• Add New Product",
        "saveText": "ðŸ’¾ Save Product",
        "cancelText": "âœ• Cancel",
        "targetTableKey": "productTable",
        "fieldMapping": {
          "productBrandId": "brandName",
          "sectorId": "sectorName",
          "classificationId": "classificationName",
          "modelName": "modelName",
          "modelNumber": "modelNumber"
        },
        "defaults": {
          "source": "New"
        }
      },
      "fieldGroup": [
        {
          "key": "productBrandId",
          "type": "select",
          "templateOptions": {
            "label": "Brand",
            "placeholder": "Choose brand...",
            "required": true,
            "options": []
          }
        },
        {
          "key": "sectorId",
          "type": "select",
          "templateOptions": {
            "label": "Sector",
            "placeholder": "Choose sector...",
            "required": true,
            "options": []
          }
        },
        {
          "key": "classificationId",
          "type": "select",
          "templateOptions": {
            "label": "Classification",
            "placeholder": "Choose classification...",
            "required": true,
            "options": []
          }
        },
        {
          "key": "modelName",
          "type": "input",
          "templateOptions": {
            "label": "Model Name",
            "placeholder": "Enter model name",
            "required": true
          }
        },
        {
          "key": "modelNumber",
          "type": "input",
          "templateOptions": {
            "label": "Model Number",
            "placeholder": "Enter model number",
            "required": true
          }
        },
        {
          "key": "barcode",
          "type": "input",
          "templateOptions": {
            "label": "Barcode",
            "placeholder": "Enter barcode (optional)",
            "required": false
          }
        }
      ]
    },
    
    {
      "key": "hasMeasurement",
      "type": "radio",
      "defaultValue": "no",
      "templateOptions": {
        "label": "Does this product have measurements?",
        "required": false,
        "options": [
          { "value": "yes", "label": "Yes" },
          { "value": "no", "label": "No" }
        ]
      }
    },
    
    {
      "key": "measurementTable",
      "type": "table",
      "showWhen": "hasMeasurementYes",
      "templateOptions": {
        "label": "Product Measurements",
        "columns": ["name", "value", "unit"],
        "columnHeaders": {
          "name": "Measurement",
          "value": "Value",
          "unit": "Unit"
        },
        "emptyMessage": "No measurements added yet.",
        "allowDelete": true
      }
    },
    
    {
      "key": "addMeasurement",
      "type": "add-to-table",
      "showWhen": "hasMeasurementYes",
      "templateOptions": {
        "addText": "âž• Add Measurement",
        "saveText": "ðŸ’¾ Save",
        "cancelText": "âœ• Cancel",
        "targetTableKey": "measurementTable",
        "fieldMapping": {
          "measurementName": "name",
          "measurementValue": "value",
          "measurementUnit": "unit"
        }
      },
      "fieldGroup": [
        {
          "key": "measurementName",
          "type": "input",
          "templateOptions": {
            "label": "Measurement Name",
            "placeholder": "e.g., Length, Width, Weight",
            "required": true
          }
        },
        {
          "key": "measurementValue",
          "type": "input",
          "templateOptions": {
            "label": "Value",
            "placeholder": "Enter value",
            "type": "number",
            "required": true
          }
        },
        {
          "key": "measurementUnit",
          "type": "input",
          "templateOptions": {
            "label": "Unit",
            "placeholder": "e.g., mm, cm, kg",
            "required": true
          }
        }
      ]
    }
  ],
  
  "stepConfig": {
    "canSendBack": true,
    "nextStep": "completed",
    "estimatedDurationHours": 48,
    "validation": {
      "type": "productTable",
      "minRequired": 1,
      "message": "Please add at least one product before proceeding"
    }
  }
}
